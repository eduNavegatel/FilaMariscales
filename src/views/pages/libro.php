<?php 
// Datos del libro - Historia de la Filá Mariscales
$libro_paginas = [
    [
        'titulo' => 'Fundación de la Filá Mariscales',
        'subtitulo' => 'Capítulo I - Los Orígenes Sagrados',
        'contenido' => [
            'En el año de Nuestro Señor 1985, cuando las estrellas se alinearon en el firmamento de Elche, un grupo de visionarios decidió crear algo extraordinario. Nacía así la Filá Mariscales de Caballeros Templarios, una comparsa que honraría la tradición medieval y el espíritu de los templarios.',
            'Los fundadores, inspirados por la nobleza y el honor de los caballeros templarios, establecieron los cimientos de lo que hoy es una de las filaes más respetadas de las Fiestas de Moros y Cristianos.',
            'Desde el primer momento, se decidió que la filá representaría a los Caballeros Templarios, una de las órdenes militares más importantes de la Edad Media, conocida por su valentía, honor y devoción a la fe cristiana.',
            'El nombre "Mariscales" fue elegido para honrar a los mariscales medievales, oficiales de alto rango que comandaban las tropas en batalla, simbolizando así el liderazgo y la estrategia militar.'
        ],
        'imagen' => 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
        'fecha' => '1985'
    ],
    [
        'titulo' => 'Los Primeros Años',
        'subtitulo' => 'Capítulo II - Construyendo la Tradición',
        'contenido' => [
            'Los primeros años fueron de aprendizaje y consolidación. Los miembros fundadores trabajaron incansablemente para establecer las bases de la filá, creando los estatutos, diseñando los trajes y organizando las primeras participaciones en las fiestas.',
            'En 1986, la Filá Mariscales participó por primera vez en las Fiestas de Moros y Cristianos de Elche, causando una gran impresión con sus trajes de caballeros templarios y su organización impecable.',
            'Durante estos años iniciales, se establecieron las tradiciones que perduran hasta hoy: el respeto por la historia, la devoción a la tradición, y el compromiso con la excelencia en cada desfile y acto.',
            'Los primeros trajes fueron diseñados con gran atención al detalle histórico, basándose en las vestimentas reales de los caballeros templarios, con sus característicos mantos blancos con la cruz roja.'
        ],
        'imagen' => 'https://images.unsplash.com/photo-1518709268805-4e9042af2176?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
        'fecha' => '1986-1990'
    ],
    [
        'titulo' => 'Época de Crecimiento',
        'subtitulo' => 'Capítulo III - Expansión y Reconocimiento',
        'contenido' => [
            'Durante la década de los 90, la Filá Mariscales experimentó un crecimiento significativo en su número de miembros y en su prestigio dentro de las fiestas. Cada año, nuevos caballeros se unían a la hermandad.',
            'En 1995, la filá celebró su décimo aniversario con una gran ceremonia que incluyó un desfile especial por las calles de Elche, conmemorando los logros alcanzados y renovando el compromiso con la tradición.',
            'Durante estos años, la filá comenzó a participar en eventos fuera de Elche, representando a la ciudad en fiestas de Moros y Cristianos de otras localidades, llevando el nombre de Elche y la tradición templaria por toda España.',
            'Se establecieron las primeras relaciones de hermanamiento con otras filaes templarias de diferentes ciudades, creando una red de hermandad que perdura hasta nuestros días.'
        ],
        'imagen' => 'https://images.unsplash.com/photo-1544966503-7cc5ac882d5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
        'fecha' => '1990-2000'
    ],
    [
        'titulo' => 'Siglo XXI - Modernización',
        'subtitulo' => 'Capítulo IV - Tradición y Progreso',
        'contenido' => [
            'Con la llegada del nuevo milenio, la Filá Mariscales emprendió un proceso de modernización que mantendría la esencia tradicional pero incorporaría las ventajas de la tecnología y la comunicación moderna.',
            'En 2005, se celebró el vigésimo aniversario con un evento que reunió a todas las generaciones de la filá, desde los fundadores hasta los miembros más jóvenes, demostrando la continuidad y vitalidad de la tradición.',
            'Durante estos años, se mejoraron significativamente los trajes y equipamiento, incorporando materiales más duraderos y cómodos, pero manteniendo la fidelidad histórica a los caballeros templarios.',
            'Se establecieron programas de formación para nuevos miembros, asegurando que cada generación comprenda y valore la historia y tradición de la filá, garantizando así la continuidad del legado templario.'
        ],
        'imagen' => 'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
        'fecha' => '2000-2010'
    ],
    [
        'titulo' => 'Era Digital y Expansión',
        'subtitulo' => 'Capítulo V - Conectando Generaciones',
        'contenido' => [
            'En la década de 2010, la Filá Mariscales abrazó la era digital, creando presencia en redes sociales y desarrollando una página web que permitiera compartir la historia y actividades de la filá con el mundo.',
            'En 2015, se celebró el trigésimo aniversario con un evento que incluyó exposiciones históricas, conferencias sobre la historia templaria, y un gran desfile que atrajo a miles de espectadores.',
            'Durante estos años, la filá comenzó a organizar eventos culturales y educativos, incluyendo charlas sobre historia medieval, talleres de heráldica, y visitas a castillos y monumentos templarios.',
            'Se establecieron programas de intercambio con otras organizaciones templarias internacionales, expandiendo el alcance y la influencia de la Filá Mariscales más allá de las fronteras españolas.'
        ],
        'imagen' => 'https://images.unsplash.com/photo-1518709268805-4e9042af2176?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
        'fecha' => '2010-2020'
    ],
    [
        'titulo' => 'El Presente y Futuro',
        'subtitulo' => 'Capítulo VI - Legado Eterno',
        'contenido' => [
            'Hoy, en 2024, la Filá Mariscales de Caballeros Templarios se encuentra en su momento más fuerte, con más de 150 miembros activos y una reputación que trasciende las fronteras de Elche.',
            'La filá continúa siendo un pilar fundamental de las Fiestas de Moros y Cristianos, manteniendo viva la tradición medieval y el espíritu de los caballeros templarios para las generaciones futuras.',
            'Los proyectos actuales incluyen la digitalización completa del archivo histórico, la creación de un museo virtual, y la expansión de los programas educativos para jóvenes interesados en la historia medieval.',
            'El compromiso con la tradición, el honor y la excelencia sigue siendo el pilar fundamental de la Filá Mariscales, asegurando que el legado de los caballeros templarios perdure por muchos siglos más.'
        ],
        'imagen' => 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
        'fecha' => '2020-Presente'
    ]
];

$total_paginas = count($libro_paginas);
?>

<!-- Hero Section -->
<section class="hero-section py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10 text-center">
                <h1 class="display-4 fw-bold text-gradient mb-4">
                    <i class="fas fa-book-open me-3"></i>Libro de la Historia
                </h1>
                <p class="lead mb-5">Crónicas de la Filá Mariscales de Caballeros Templarios</p>
                <div class="book-stats d-flex justify-content-center gap-4 mb-5">
                    <div class="stat-item">
                        <h3 class="text-gradient mb-0"><?php echo $total_paginas; ?></h3>
                        <small class="text-muted">Capítulos</small>
                    </div>
                    <div class="stat-item">
                        <h3 class="text-gradient mb-0">39</h3>
                        <small class="text-muted">Años de Historia</small>
                    </div>
                    <div class="stat-item">
                        <h3 class="text-gradient mb-0">150+</h3>
                        <small class="text-muted">Miembros</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Flip Book Container -->
<section class="flipbook-section py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-12">
                
                <div id="flipbookContainer" class="flipbook-container">
                    <div class="flipbook-loading">
                        Cargando el libro histórico...
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
/* Book Styles */
.hero-section {
    background: linear-gradient(135deg, rgba(220, 20, 60, 0.05) 0%, rgba(255, 255, 255, 0.7) 50%, rgba(220, 20, 60, 0.05) 100%);
    border-bottom: 3px solid var(--primary);
}

.book-stats .stat-item {
    text-align: center;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.7);
    border-radius: 10px;
    border: 2px solid var(--primary);
    min-width: 120px;
}

/* Responsive */
@media (max-width: 768px) {
    
    .book-stats {
        flex-direction: column;
        gap: 1rem;
    }
}
</style>

<script>
// Datos del libro para el flip book
const libroPaginas = <?php echo json_encode($libro_paginas); ?>;

document.addEventListener('DOMContentLoaded', function() {
    const chapterBtns = document.querySelectorAll('.chapter-btn');
    let flipBookInstance = null;
    
    // Inicializar el flip book
    function initFlipBookInstance() {
        if (typeof FlipBook !== 'undefined') {
            flipBookInstance = new FlipBook(document.getElementById('flipbookContainer'), libroPaginas);
            
            // Conectar botones de capítulos con el flip book
            chapterBtns.forEach((btn, index) => {
                btn.addEventListener('click', () => {
                    flipBookInstance.goToPage(index);
                });
            });
        } else {
            console.error('FlipBook class no está disponible');
            setTimeout(initFlipBookInstance, 500);
        }
    }
    
    // Cargar recursos del flip book
    function loadFlipBookResources() {
        // Cargar CSS
        if (!document.querySelector('link[href*="flipbook.css"]')) {
            const flipbookCSS = document.createElement('link');
            flipbookCSS.rel = 'stylesheet';
            flipbookCSS.href = '/prueba-php/public/assets/css/flipbook.css';
            document.head.appendChild(flipbookCSS);
        }
        
        // Cargar JS
        if (!document.querySelector('script[src*="flipbook.js"]')) {
            const flipbookJS = document.createElement('script');
            flipbookJS.src = '/prueba-php/public/assets/js/flipbook.js';
            flipbookJS.onload = () => {
                setTimeout(initFlipBookInstance, 100);
            };
            document.head.appendChild(flipbookJS);
        } else {
            setTimeout(initFlipBookInstance, 100);
        }
    }
    
    // Iniciar carga de recursos
    loadFlipBookResources();
});
</script>

