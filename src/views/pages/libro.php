<?php 
// Datos del libro - Historia de la Filá Mariscales
$libro_paginas = [
    [
        'titulo' => 'Fundación de la Filá Mariscales',
        'subtitulo' => 'Capítulo I - Los Orígenes Sagrados',
        'contenido' => [
            'En el año de Nuestro Señor 1985, cuando las estrellas se alinearon en el firmamento de Elche, un grupo de visionarios decidió crear algo extraordinario. Nacía así la Filá Mariscales de Caballeros Templarios, una comparsa que honraría la tradición medieval y el espíritu de los templarios.',
            'Los fundadores, inspirados por la nobleza y el honor de los caballeros templarios, establecieron los cimientos de lo que hoy es una de las filaes más respetadas de las Fiestas de Moros y Cristianos.',
            'Desde el primer momento, se decidió que la filá representaría a los Caballeros Templarios, una de las órdenes militares más importantes de la Edad Media, conocida por su valentía, honor y devoción a la fe cristiana.',
            'El nombre "Mariscales" fue elegido para honrar a los mariscales medievales, oficiales de alto rango que comandaban las tropas en batalla, simbolizando así el liderazgo y la estrategia militar.'
        ],
        'imagen' => 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
        'fecha' => '1985'
    ],
    [
        'titulo' => 'Los Primeros Años',
        'subtitulo' => 'Capítulo II - Construyendo la Tradición',
        'contenido' => [
            'Los primeros años fueron de aprendizaje y consolidación. Los miembros fundadores trabajaron incansablemente para establecer las bases de la filá, creando los estatutos, diseñando los trajes y organizando las primeras participaciones en las fiestas.',
            'En 1986, la Filá Mariscales participó por primera vez en las Fiestas de Moros y Cristianos de Elche, causando una gran impresión con sus trajes de caballeros templarios y su organización impecable.',
            'Durante estos años iniciales, se establecieron las tradiciones que perduran hasta hoy: el respeto por la historia, la devoción a la tradición, y el compromiso con la excelencia en cada desfile y acto.',
            'Los primeros trajes fueron diseñados con gran atención al detalle histórico, basándose en las vestimentas reales de los caballeros templarios, con sus característicos mantos blancos con la cruz roja.'
        ],
        'imagen' => 'https://images.unsplash.com/photo-1518709268805-4e9042af2176?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
        'fecha' => '1986-1990'
    ],
    [
        'titulo' => 'Época de Crecimiento',
        'subtitulo' => 'Capítulo III - Expansión y Reconocimiento',
        'contenido' => [
            'Durante la década de los 90, la Filá Mariscales experimentó un crecimiento significativo en su número de miembros y en su prestigio dentro de las fiestas. Cada año, nuevos caballeros se unían a la hermandad.',
            'En 1995, la filá celebró su décimo aniversario con una gran ceremonia que incluyó un desfile especial por las calles de Elche, conmemorando los logros alcanzados y renovando el compromiso con la tradición.',
            'Durante estos años, la filá comenzó a participar en eventos fuera de Elche, representando a la ciudad en fiestas de Moros y Cristianos de otras localidades, llevando el nombre de Elche y la tradición templaria por toda España.',
            'Se establecieron las primeras relaciones de hermanamiento con otras filaes templarias de diferentes ciudades, creando una red de hermandad que perdura hasta nuestros días.'
        ],
        'imagen' => 'https://images.unsplash.com/photo-1544966503-7cc5ac882d5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
        'fecha' => '1990-2000'
    ],
    [
        'titulo' => 'Siglo XXI - Modernización',
        'subtitulo' => 'Capítulo IV - Tradición y Progreso',
        'contenido' => [
            'Con la llegada del nuevo milenio, la Filá Mariscales emprendió un proceso de modernización que mantendría la esencia tradicional pero incorporaría las ventajas de la tecnología y la comunicación moderna.',
            'En 2005, se celebró el vigésimo aniversario con un evento que reunió a todas las generaciones de la filá, desde los fundadores hasta los miembros más jóvenes, demostrando la continuidad y vitalidad de la tradición.',
            'Durante estos años, se mejoraron significativamente los trajes y equipamiento, incorporando materiales más duraderos y cómodos, pero manteniendo la fidelidad histórica a los caballeros templarios.',
            'Se establecieron programas de formación para nuevos miembros, asegurando que cada generación comprenda y valore la historia y tradición de la filá, garantizando así la continuidad del legado templario.'
        ],
        'imagen' => 'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
        'fecha' => '2000-2010'
    ],
    [
        'titulo' => 'Era Digital y Expansión',
        'subtitulo' => 'Capítulo V - Conectando Generaciones',
        'contenido' => [
            'En la década de 2010, la Filá Mariscales abrazó la era digital, creando presencia en redes sociales y desarrollando una página web que permitiera compartir la historia y actividades de la filá con el mundo.',
            'En 2015, se celebró el trigésimo aniversario con un evento que incluyó exposiciones históricas, conferencias sobre la historia templaria, y un gran desfile que atrajo a miles de espectadores.',
            'Durante estos años, la filá comenzó a organizar eventos culturales y educativos, incluyendo charlas sobre historia medieval, talleres de heráldica, y visitas a castillos y monumentos templarios.',
            'Se establecieron programas de intercambio con otras organizaciones templarias internacionales, expandiendo el alcance y la influencia de la Filá Mariscales más allá de las fronteras españolas.'
        ],
        'imagen' => 'https://images.unsplash.com/photo-1518709268805-4e9042af2176?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
        'fecha' => '2010-2020'
    ],
    [
        'titulo' => 'El Presente y Futuro',
        'subtitulo' => 'Capítulo VI - Legado Eterno',
        'contenido' => [
            'Hoy, en 2024, la Filá Mariscales de Caballeros Templarios se encuentra en su momento más fuerte, con más de 150 miembros activos y una reputación que trasciende las fronteras de Elche.',
            'La filá continúa siendo un pilar fundamental de las Fiestas de Moros y Cristianos, manteniendo viva la tradición medieval y el espíritu de los caballeros templarios para las generaciones futuras.',
            'Los proyectos actuales incluyen la digitalización completa del archivo histórico, la creación de un museo virtual, y la expansión de los programas educativos para jóvenes interesados en la historia medieval.',
            'El compromiso con la tradición, el honor y la excelencia sigue siendo el pilar fundamental de la Filá Mariscales, asegurando que el legado de los caballeros templarios perdure por muchos siglos más.'
        ],
        'imagen' => 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
        'fecha' => '2020-Presente'
    ]
];

$total_paginas = count($libro_paginas);
?>

<!-- Hero Section -->
<section class="hero-section py-5" style="background: linear-gradient(135deg, rgba(220, 20, 60, 0.1) 0%, rgba(255, 255, 255, 0.8) 50%, rgba(220, 20, 60, 0.1) 100%);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10 text-center">
                <h1 class="display-4 fw-bold text-gradient mb-4">
                    <i class="bi bi-book-open me-3"></i>Libro de la Historia
                </h1>
                <p class="lead mb-5">Crónicas de la Filá Mariscales de Caballeros Templarios</p>
                <div class="book-stats d-flex justify-content-center gap-4 mb-5">
                    <div class="stat-item">
                        <h3 class="text-gradient mb-0"><?php echo $total_paginas; ?></h3>
                        <small class="text-muted">Capítulos</small>
                    </div>
                    <div class="stat-item">
                        <h3 class="text-gradient mb-0">39</h3>
                        <small class="text-muted">Años de Historia</small>
                    </div>
                    <div class="stat-item">
                        <h3 class="text-gradient mb-0">150+</h3>
                        <small class="text-muted">Miembros</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Interactive Book Section -->
<section class="interactive-book-section py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-12">
                <div class="book-container">
                    <!-- Book Controls -->
                    <div class="book-controls">
                        <button id="openBook" class="btn btn-primary btn-lg">
                            <i class="bi bi-book me-2"></i>Abrir Libro
                        </button>
                        <div class="page-info" id="pageInfo" style="display: none;">
                            <span id="currentPage">1</span> de <?php echo $total_paginas; ?>
                        </div>
                        <div class="book-nav" id="bookNav" style="display: none;">
                            <button id="prevPage" class="btn btn-outline-danger">
                                <i class="bi bi-chevron-left"></i>
                            </button>
                        <button id="nextPage" class="btn btn-outline-danger">
                                <i class="bi bi-chevron-right"></i>
                        </button>
                        </div>
                    </div>
                    
                    <!-- Interactive Book -->
                    <div class="interactive-book" id="interactiveBook">
                        <!-- Book Cover (Closed State) -->
                        <div class="book-cover" id="bookCover">
                            <div class="cover-front">
                                <div class="cover-background">
                                    <div class="cover-pattern"></div>
                                </div>
                                <div class="cover-content">
                                    <div class="cover-logo">
                                        <div class="templar-shield">🛡️</div>
                                    </div>
                                    <div class="cover-title">
                                        <h2 class="cover-subtitle">Historia de la</h2>
                                        <h1 class="cover-main-title">Filá Mariscales</h1>
                                        <h3 class="cover-subtitle-2">Caballeros Templarios</h3>
                                    </div>
                                    <div class="cover-details">
                                        <div class="cover-location">Elche, Alicante</div>
                                        <div class="cover-years">1985 - 2024</div>
                                    </div>
                                    <div class="cover-decoration">
                                        <div class="decorative-line"></div>
                                        <div class="templar-cross">⚔️</div>
                                        <div class="decorative-line"></div>
                                    </div>
                                    <div class="cover-footer">
                                        <div class="cover-author">Crónicas Oficiales</div>
                                        <div class="cover-edition">Primera Edición</div>
                                    </div>
                                </div>
                            </div>
                            <div class="cover-spine">
                                <div class="spine-pattern"></div>
                                <div class="spine-content">
                                    <div class="spine-title">Historia</div>
                                    <div class="spine-subtitle">Filá Mariscales</div>
                                    <div class="spine-decoration">⚔️</div>
                                </div>
                            </div>
                            <div class="cover-back">
                                <div class="back-pattern"></div>
                                <div class="back-content">
                                    <div class="back-logo">🛡️</div>
                                    <div class="back-title">Crónicas Templarias</div>
                                    <div class="back-description">
                                        Una historia de honor, tradición y hermandad que perdura a través de los siglos. 
                                        Desde su fundación en 1985 hasta nuestros días, la Filá Mariscales ha mantenido 
                                        viva la llama de la tradición templaria en las Fiestas de Moros y Cristianos de Elche.
                                    </div>
                                    <div class="back-symbols">
                                        <span class="symbol">🛡️</span>
                                        <span class="symbol">⚔️</span>
                                        <span class="symbol">🏰</span>
                                        <span class="symbol">👑</span>
                                    </div>
                                    <div class="back-footer">
                                        <div class="back-isbn">ISBN: 978-84-XXXX-XXX-X</div>
                                        <div class="back-publisher">Ediciones Templarias</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Book Pages (Open State) -->
                        <div class="book-pages" id="bookPages" style="display: none;">
                            <!-- Left Page -->
                            <div class="book-page left-page" id="leftPage">
                                <div class="page-content">
                                    <div class="page-header">
                                        <div class="page-number" id="leftPageNumber">1</div>
                                        <div class="page-date" id="leftPageDate">1985</div>
                                    </div>
                                    <div class="page-body">
                                                <h2 class="page-title" id="leftPageTitle">Fundación de la Filá Mariscales</h2>
                                                <h4 class="page-subtitle" id="leftPageSubtitle">Capítulo I - Los Orígenes Sagrados</h4>
                                                <div class="page-text" id="leftPageText">
                                            <p>En el año de Nuestro Señor 1985, cuando las estrellas se alinearon en el firmamento de Elche, un grupo de visionarios decidió crear algo extraordinario.</p>
                                            <p>Nacía así la Filá Mariscales de Caballeros Templarios, una comparsa que honraría la tradición medieval y el espíritu de los templarios.</p>
                                                </div>
                                                <div class="page-image">
                                            <img id="leftPageImage" src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80" alt="Imagen del capítulo">
                                                </div>
                                            </div>
                                    <div class="page-footer">
                                        <div class="page-quote">
                                            <blockquote>
                                                <p>"La tradición no es adorar las cenizas, sino mantener viva la llama."</p>
                                                    <cite>Filá Mariscales</cite>
                                            </blockquote>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Right Page -->
                            <div class="book-page right-page" id="rightPage">
                                <div class="page-content">
                                    <div class="page-header">
                                        <div class="page-number" id="rightPageNumber">2</div>
                                        <div class="page-date" id="rightPageDate">1986-1990</div>
                                    </div>
                                    <div class="page-body">
                                                <h2 class="page-title" id="rightPageTitle">Los Primeros Años</h2>
                                                <h4 class="page-subtitle" id="rightPageSubtitle">Capítulo II - Construyendo la Tradición</h4>
                                                <div class="page-text" id="rightPageText">
                                            <p>Los primeros años fueron de aprendizaje y consolidación. Los miembros fundadores trabajaron incansablemente para establecer las bases de la filá.</p>
                                            <p>En 1986, la Filá Mariscales participó por primera vez en las Fiestas de Moros y Cristianos de Elche.</p>
                                                </div>
                                                <div class="page-image">
                                            <img id="rightPageImage" src="https://images.unsplash.com/photo-1518709268805-4e9042af2176?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80" alt="Imagen del capítulo">
                                                </div>
                                            </div>
                                    <div class="page-footer">
                                        <div class="page-quote">
                                            <blockquote>
                                                <p>"El honor se gana con hechos, no con palabras."</p>
                                                <cite>Caballeros Templarios</cite>
                                            </blockquote>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Chapter Navigation -->
<section class="chapter-nav py-4" style="display: none;" id="chapterNav">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <h4 class="text-center mb-4">Navegación por Capítulos</h4>
                <div class="chapter-grid">
                    <?php foreach ($libro_paginas as $index => $pagina): ?>
                    <button class="chapter-btn" data-page="<?php echo $index + 1; ?>">
                        <div class="chapter-number"><?php echo $index + 1; ?></div>
                        <div class="chapter-title"><?php echo $pagina['titulo']; ?></div>
                        <div class="chapter-date"><?php echo $pagina['fecha']; ?></div>
                    </button>
                    <?php endforeach; ?>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
/* Hero Section */
.hero-section {
    background: linear-gradient(135deg, rgba(220, 20, 60, 0.05) 0%, rgba(255, 255, 255, 0.7) 50%, rgba(220, 20, 60, 0.05) 100%);
    border-bottom: 3px solid var(--primary);
    backdrop-filter: blur(5px);
}

.book-stats .stat-item {
    text-align: center;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.7);
    border-radius: 10px;
    border: 2px solid var(--primary);
    min-width: 120px;
    backdrop-filter: blur(10px);
}

/* Interactive Book Styles */
.interactive-book-section {
    background: linear-gradient(135deg, rgba(248, 249, 250, 0.8) 0%, rgba(233, 236, 239, 0.8) 100%);
    min-height: 80vh;
    perspective: 2000px;
}

.book-container {
    position: relative;
    max-width: 1000px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.book-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 2rem;
    margin-bottom: 3rem;
    padding: 1.5rem;
    background: rgba(255, 255, 255, 0.9);
    border-radius: 15px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(10px);
}

.page-info {
    font-family: 'Cinzel', serif;
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--primary);
    padding: 0.5rem 1rem;
    background: rgba(220, 20, 60, 0.1);
    border-radius: 8px;
}

.book-nav {
    display: flex;
    gap: 1rem;
}

/* Book Cover Styles */
.interactive-book {
    position: relative;
    width: 600px;
    height: 400px;
    transform-style: preserve-3d;
    transition: all 1s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
}

.book-cover {
    position: relative;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform 1.5s cubic-bezier(0.4, 0, 0.2, 1);
}

.book-cover.opened {
    transform: rotateY(-180deg);
}

.cover-front, .cover-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 8px;
    box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.3),
        0 0 0 1px rgba(0, 0, 0, 0.1),
        inset 0 0 0 1px rgba(255, 255, 255, 0.2);
    overflow: hidden;
}

.cover-front {
    background: linear-gradient(135deg, #8B4513 0%, #A0522D 30%, #CD853F 50%, #A0522D 70%, #8B4513 100%);
    position: relative;
}

.cover-back {
    background: linear-gradient(135deg, #654321 0%, #8B4513 30%, #A0522D 50%, #8B4513 70%, #654321 100%);
    transform: rotateY(180deg);
    position: relative;
}

/* Cover Background Patterns */
.cover-background, .back-pattern {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0.1;
    background-image: 
        radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.1) 1px, transparent 1px),
        radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
    background-size: 30px 30px;
}

.cover-pattern, .spine-pattern {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
        linear-gradient(45deg, transparent 40%, rgba(255, 255, 255, 0.05) 50%, transparent 60%),
        linear-gradient(-45deg, transparent 40%, rgba(255, 255, 255, 0.05) 50%, transparent 60%);
    background-size: 20px 20px;
}

/* Cover Content */
.cover-content, .back-content {
    position: relative;
    z-index: 2;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    text-align: center;
    color: #DAA520;
    padding: 2rem;
}

.cover-logo {
    margin-bottom: 1rem;
}

.templar-shield, .back-logo {
    font-size: 3rem;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    animation: glow 2s ease-in-out infinite alternate;
}

.cover-title {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.cover-main-title {
    font-family: 'Cinzel', serif;
    font-size: 2.8rem;
    font-weight: 700;
    margin: 0.5rem 0;
    text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.7);
    letter-spacing: 2px;
}

.cover-subtitle, .cover-subtitle-2 {
    font-family: 'Cinzel', serif;
    font-size: 1.1rem;
    font-weight: 600;
    margin: 0.2rem 0;
    opacity: 0.9;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}

.cover-details {
    margin: 1rem 0;
    font-family: 'Crimson Text', serif;
    font-size: 0.9rem;
    opacity: 0.8;
}

.cover-location, .cover-years {
    margin: 0.2rem 0;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

.cover-decoration {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin: 1rem 0;
}

.decorative-line {
    width: 40px;
    height: 2px;
    background: linear-gradient(90deg, transparent, #DAA520, transparent);
    box-shadow: 0 0 5px rgba(218, 165, 32, 0.5);
}

.templar-cross {
    font-size: 1.5rem;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}

.cover-footer {
    margin-top: 1rem;
    font-family: 'Crimson Text', serif;
    font-size: 0.8rem;
    opacity: 0.7;
}

.cover-author, .cover-edition {
    margin: 0.2rem 0;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

.cover-title h1 {
    font-family: 'Cinzel', serif;
    font-size: 2.5rem;
    font-weight: 700;
    margin: 0.5rem 0;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}

.cover-title h2, .cover-title h3 {
    font-family: 'Cinzel', serif;
    font-size: 1.2rem;
    font-weight: 600;
    margin: 0.2rem 0;
    opacity: 0.9;
}

.cover-subtitle {
    font-family: 'Crimson Text', serif;
    font-size: 1rem;
    font-style: italic;
    margin-top: 1rem;
    opacity: 0.8;
}

.cover-decoration {
    margin-top: 1.5rem;
}

.templar-cross {
    font-size: 3rem;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    animation: glow 2s ease-in-out infinite alternate;
}

@keyframes glow {
    from { text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5), 0 0 10px rgba(218, 165, 32, 0.3); }
    to { text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5), 0 0 20px rgba(218, 165, 32, 0.6); }
}

.cover-spine {
    position: absolute;
    left: -15px;
    top: 0;
    width: 30px;
    height: 100%;
    background: linear-gradient(90deg, #654321 0%, #8B4513 30%, #A0522D 50%, #8B4513 70%, #654321 100%);
    transform: rotateY(-90deg);
    transform-origin: left center;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 
        -5px 0 15px rgba(0, 0, 0, 0.3),
        5px 0 15px rgba(0, 0, 0, 0.3);
    position: relative;
    overflow: hidden;
}

.spine-content {
    position: relative;
    z-index: 2;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    writing-mode: vertical-rl;
    text-orientation: mixed;
    color: #DAA520;
    font-size: 0.8rem;
    font-weight: 600;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

.spine-title, .spine-subtitle {
    font-family: 'Cinzel', serif;
    font-size: 0.7rem;
    font-weight: 600;
    letter-spacing: 1px;
}

.spine-decoration {
    font-size: 1rem;
    margin-top: 0.5rem;
}

.spine-text {
    color: #DAA520;
    font-family: 'Cinzel', serif;
    font-size: 0.7rem;
    font-weight: 700;
    text-align: center;
    transform: rotate(90deg);
    white-space: nowrap;
}

.back-content {
    text-align: center;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
}

.back-logo {
    font-size: 2.5rem;
    margin-bottom: 1rem;
}

.back-title {
    font-family: 'Cinzel', serif;
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 1rem;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    color: #DAA520;
}

.back-description {
    font-family: 'Crimson Text', serif;
    font-size: 0.85rem;
    line-height: 1.6;
    margin-bottom: 1.5rem;
    opacity: 0.9;
    max-width: 80%;
    text-align: justify;
}

.back-symbols {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin: 1rem 0;
}

.symbol {
    font-size: 1.5rem;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    animation: float 3s ease-in-out infinite;
}

.symbol:nth-child(2) { animation-delay: 0.5s; }
.symbol:nth-child(3) { animation-delay: 1s; }
.symbol:nth-child(4) { animation-delay: 1.5s; }

.back-footer {
    margin-top: auto;
    font-family: 'Crimson Text', serif;
    font-size: 0.7rem;
    opacity: 0.7;
    text-align: center;
}

.back-isbn, .back-publisher {
    margin: 0.2rem 0;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-5px); }
}

/* Book Pages Styles */
.book-pages {
    position: relative;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    display: flex;
    gap: 2px;
}

.book-page {
    position: relative;
    width: 49%;
    height: 100%;
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 4px;
    box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.2),
        inset 0 0 0 1px rgba(255, 255, 255, 0.8);
    overflow: hidden;
    transition: all 0.3s ease;
}

.book-page:hover {
    box-shadow: 
        0 15px 40px rgba(0, 0, 0, 0.3),
        inset 0 0 0 1px rgba(255, 255, 255, 0.8);
    transform: translateY(-2px);
}

.page-content {
    height: 100%;
    display: flex;
    flex-direction: column;
    padding: 0;
    background: 
        linear-gradient(90deg, transparent 0%, rgba(0,0,0,0.02) 50%, transparent 100%),
        radial-gradient(circle at 50% 50%, rgba(0,0,0,0.05) 0%, transparent 70%);
}

.page-header {
    background: linear-gradient(135deg, rgba(220, 20, 60, 0.9) 0%, rgba(139, 0, 0, 0.9) 100%);
    color: white;
    padding: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-family: 'Cinzel', serif;
    border-bottom: 2px solid #8B4513;
}

.page-number {
    font-size: 1rem;
    font-weight: 700;
}

.page-date {
    font-size: 0.8rem;
    opacity: 0.9;
}

.page-body {
    flex: 1;
    padding: 1.5rem;
    background: rgba(255, 255, 255, 0.95);
    overflow-y: auto;
}

.page-title {
    font-family: 'Cinzel', serif;
    font-size: 1.4rem;
    font-weight: 700;
    color: var(--primary);
    border-bottom: 2px solid var(--accent);
    padding-bottom: 0.5rem;
    margin-bottom: 0.5rem;
}

.page-subtitle {
    font-family: 'Crimson Text', serif;
    font-style: italic;
    font-size: 0.9rem;
    color: #666;
    margin-bottom: 1rem;
}

.page-text p {
    font-family: 'Crimson Text', serif;
    font-size: 0.8rem;
    line-height: 1.6;
    text-align: justify;
    color: #333;
    margin-bottom: 0.8rem;
}

.page-image {
    margin-top: 1rem;
    text-align: center;
}

.page-image img {
    width: 100%;
    max-width: 200px;
    height: 120px;
    object-fit: cover;
    border-radius: 6px;
    border: 2px solid var(--accent);
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
}

.page-footer {
    background: linear-gradient(135deg, rgba(248, 249, 250, 0.9) 0%, rgba(233, 236, 239, 0.9) 100%);
    padding: 1rem;
    border-top: 2px solid var(--primary);
}

.page-quote {
    text-align: center;
    font-style: italic;
}

.page-quote blockquote {
    border-left: 3px solid var(--primary);
    padding-left: 0.8rem;
    margin: 0;
}

.page-quote p {
    font-size: 0.7rem;
    color: #555;
    margin-bottom: 0.3rem;
}

.page-quote cite {
    font-size: 0.6rem;
    color: var(--primary);
    font-weight: 600;
}

/* Chapter Navigation */
.chapter-nav {
    background: rgba(248, 249, 250, 0.8);
    border-top: 2px solid var(--primary);
    backdrop-filter: blur(10px);
}

.chapter-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
}

.chapter-btn {
    background: rgba(255, 255, 255, 0.9);
    border: 2px solid var(--primary);
    border-radius: 10px;
    padding: 1.5rem;
    text-align: center;
    transition: all 0.3s ease;
    cursor: pointer;
    backdrop-filter: blur(5px);
}

.chapter-btn:hover {
    background: var(--primary);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(220, 20, 60, 0.3);
}

.chapter-btn.active {
    background: var(--primary);
    color: white;
    box-shadow: 0 5px 15px rgba(220, 20, 60, 0.3);
}

.chapter-number {
    font-family: 'Cinzel', serif;
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
}

.chapter-title {
    font-family: 'Cinzel', serif;
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.chapter-date {
    font-size: 0.9rem;
    opacity: 0.8;
}

/* Page Flip Animation */
.page-flipping {
    animation: pageFlip 0.8s ease-in-out;
}

@keyframes pageFlip {
    0% { transform: scale(1) rotateY(0deg); }
    50% { transform: scale(1.05) rotateY(-5deg); }
    100% { transform: scale(1) rotateY(0deg); }
}

/* Responsive Design */
@media (max-width: 768px) {
    .interactive-book {
        width: 400px;
        height: 300px;
    }
    
    .cover-title h1 {
        font-size: 1.8rem;
    }
    
    .cover-title h2, .cover-title h3 {
        font-size: 1rem;
    }
    
    .book-controls {
        flex-direction: column;
        gap: 1rem;
    }
    
    .chapter-grid {
        grid-template-columns: 1fr;
    }
    
    .book-stats {
        flex-direction: column;
        gap: 1rem;
    }
}

@media (max-width: 480px) {
    .interactive-book {
        width: 300px;
        height: 250px;
    }
    
    .cover-title h1 {
        font-size: 1.4rem;
    }
    
    .page-body {
        padding: 1rem;
    }
    
    .page-title {
        font-size: 1.1rem;
    }
    
    .page-text p {
        font-size: 0.7rem;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Datos del libro desde PHP
    const libroPaginas = <?php echo json_encode($libro_paginas); ?>;
    
    // Elementos del DOM
    const openBookBtn = document.getElementById('openBook');
    const bookCover = document.getElementById('bookCover');
    const bookPages = document.getElementById('bookPages');
    const pageInfo = document.getElementById('pageInfo');
    const bookNav = document.getElementById('bookNav');
    const chapterNav = document.getElementById('chapterNav');
    const prevBtn = document.getElementById('prevPage');
    const nextBtn = document.getElementById('nextPage');
    const currentPageSpan = document.getElementById('currentPage');
    const chapterBtns = document.querySelectorAll('.chapter-btn');
    
    // Elementos de las páginas
    const leftPageNumber = document.getElementById('leftPageNumber');
    const leftPageDate = document.getElementById('leftPageDate');
    const leftPageTitle = document.getElementById('leftPageTitle');
    const leftPageSubtitle = document.getElementById('leftPageSubtitle');
    const leftPageText = document.getElementById('leftPageText');
    const leftPageImage = document.getElementById('leftPageImage');
    
    const rightPageNumber = document.getElementById('rightPageNumber');
    const rightPageDate = document.getElementById('rightPageDate');
    const rightPageTitle = document.getElementById('rightPageTitle');
    const rightPageSubtitle = document.getElementById('rightPageSubtitle');
    const rightPageText = document.getElementById('rightPageText');
    const rightPageImage = document.getElementById('rightPageImage');
    
    // Estado del libro
    let isBookOpen = false;
    let currentPage = 1;
    const totalPages = libroPaginas.length;
    let isFlipping = false;
    
    // Función para abrir el libro
    function openBook() {
        if (isBookOpen) return;
        
        console.log('Abriendo libro...');
        
        // Animación de apertura
        bookCover.classList.add('opened');
        
        setTimeout(() => {
            bookCover.style.display = 'none';
            bookPages.style.display = 'flex';
            pageInfo.style.display = 'block';
            bookNav.style.display = 'flex';
            chapterNav.style.display = 'block';
            openBookBtn.style.display = 'none';
            
            isBookOpen = true;
            showPage(1);
            
            console.log('Libro abierto');
        }, 1500);
    }
    
    // Función para actualizar el contenido de una página
    function updatePageContent(pageIndex, isLeftPage) {
        const pagina = libroPaginas[pageIndex];
        if (!pagina) return;
        
        const pageNumber = pageIndex + 1;
        const elements = isLeftPage ? {
            number: leftPageNumber,
            date: leftPageDate,
            title: leftPageTitle,
            subtitle: leftPageSubtitle,
            text: leftPageText,
            image: leftPageImage
        } : {
            number: rightPageNumber,
            date: rightPageDate,
            title: rightPageTitle,
            subtitle: rightPageSubtitle,
            text: rightPageText,
            image: rightPageImage
        };
        
        elements.number.textContent = pageNumber;
        elements.date.textContent = pagina.fecha;
        elements.title.textContent = pagina.titulo;
        elements.subtitle.textContent = pagina.subtitulo;
        
        // Actualizar texto
        elements.text.innerHTML = '';
        pagina.contenido.forEach(parrafo => {
            const p = document.createElement('p');
            p.textContent = parrafo;
            elements.text.appendChild(p);
        });
        
        // Actualizar imagen
        elements.image.src = pagina.imagen;
        elements.image.alt = pagina.titulo;
    }
    
    // Función para cerrar el libro
    function closeBook() {
        if (!isBookOpen) return;
        
        console.log('Cerrando libro...');
        
        // Ocultar páginas y controles
        bookPages.style.display = 'none';
        pageInfo.style.display = 'none';
        bookNav.style.display = 'none';
        chapterNav.style.display = 'none';
        
        // Mostrar tapa y botón de abrir
        bookCover.style.display = 'block';
        openBookBtn.style.display = 'block';
        
        // Resetear estado
        isBookOpen = false;
        currentPage = 1;
        
        // Animación de cierre
        bookCover.classList.remove('opened');
        
        console.log('Libro cerrado');
    }
    
    // Función para mostrar una página específica
    function showPage(pageNumber) {
        if (isFlipping || pageNumber < 1 || pageNumber > totalPages) return;
        
        isFlipping = true;
        console.log(`Mostrando página ${pageNumber}`);
        
        // Calcular qué páginas mostrar
        const leftPageIndex = pageNumber - 1;
        const rightPageIndex = pageNumber;
        
        // Actualizar contenido de las páginas
        updatePageContent(leftPageIndex, true);
        if (rightPageIndex < totalPages) {
            updatePageContent(rightPageIndex, false);
        } else {
            // Si no hay página derecha, mostrar mensaje de fin
            rightPageTitle.textContent = 'Fin del Libro';
            rightPageSubtitle.textContent = 'La historia continúa...';
            rightPageText.innerHTML = '<p>Gracias por leer la historia de la Filá Mariscales de Caballeros Templarios. La tradición continúa con cada nueva generación.</p>';
            rightPageImage.src = 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80';
        }
        
        // Actualizar navegación
            currentPageSpan.textContent = pageNumber;
            
        // Actualizar botones de capítulo
            chapterBtns.forEach(btn => {
                btn.classList.remove('active');
            });
            
            const targetBtn = document.querySelector(`.chapter-btn[data-page="${pageNumber}"]`);
            if (targetBtn) {
                targetBtn.classList.add('active');
            }
            
        // Actualizar botones de navegación
            prevBtn.disabled = pageNumber === 1;
            nextBtn.disabled = pageNumber === totalPages;
            
        // Efecto de volteo de página
        const leftPage = document.getElementById('leftPage');
        const rightPage = document.getElementById('rightPage');
        
        // Aplicar animación de volteo
        leftPage.classList.add('page-flipping');
        rightPage.classList.add('page-flipping');
        
        setTimeout(() => {
            leftPage.classList.remove('page-flipping');
            rightPage.classList.remove('page-flipping');
            isFlipping = false;
        }, 800);
    }
    
    // Event Listeners
    openBookBtn.addEventListener('click', openBook);
    
    prevBtn.addEventListener('click', () => {
        if (currentPage > 1 && !isFlipping) {
            currentPage--;
            showPage(currentPage);
        }
    });
    
    nextBtn.addEventListener('click', () => {
        if (currentPage < totalPages && !isFlipping) {
            currentPage++;
            showPage(currentPage);
        } else if (currentPage === totalPages && !isFlipping) {
            // Si estamos en la última página, cerrar el libro
            closeBook();
        }
    });
    
    chapterBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            const pageNumber = parseInt(btn.dataset.page);
            if (pageNumber !== currentPage && !isFlipping) {
                currentPage = pageNumber;
                showPage(pageNumber);
            }
        });
    });
    
    // Navegación con teclado
    document.addEventListener('keydown', (e) => {
        if (!isBookOpen || isFlipping) return;
        
        if (e.key === 'ArrowLeft' && currentPage > 1) {
            currentPage--;
            showPage(currentPage);
        } else if (e.key === 'ArrowRight' && currentPage < totalPages) {
            currentPage++;
            showPage(currentPage);
        } else if (e.key === 'ArrowRight' && currentPage === totalPages) {
            // Si estamos en la última página, cerrar el libro
            closeBook();
        }
    });
    
    // Soporte para gestos táctiles
    let startX = 0;
    let startY = 0;
    
    document.addEventListener('touchstart', (e) => {
        if (!isBookOpen) return;
        startX = e.touches[0].clientX;
        startY = e.touches[0].clientY;
    });
    
    document.addEventListener('touchend', (e) => {
        if (!isBookOpen || isFlipping) return;
        
        const endX = e.changedTouches[0].clientX;
        const endY = e.changedTouches[0].clientY;
        const diffX = startX - endX;
        const diffY = startY - endY;
        
        // Solo activar si el deslizamiento horizontal es más significativo que el vertical
        if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
            if (diffX > 0 && currentPage < totalPages) {
                // Deslizar izquierda - página siguiente
                currentPage++;
                showPage(currentPage);
            } else if (diffX > 0 && currentPage === totalPages) {
                // Deslizar izquierda en la última página - cerrar libro
                closeBook();
            } else if (diffX < 0 && currentPage > 1) {
                // Deslizar derecha - página anterior
                currentPage--;
                showPage(currentPage);
            }
        }
    });
    
    // Click en las páginas para navegar
    document.getElementById('leftPage').addEventListener('click', () => {
                if (currentPage > 1 && !isFlipping) {
                    currentPage--;
                    showPage(currentPage);
                }
    });
    
    document.getElementById('rightPage').addEventListener('click', () => {
                if (currentPage < totalPages && !isFlipping) {
                    currentPage++;
                    showPage(currentPage);
        } else if (currentPage === totalPages && !isFlipping) {
            // Si estamos en la última página, cerrar el libro
            closeBook();
        }
    });
    
    console.log('Libro interactivo inicializado');
});
</script>